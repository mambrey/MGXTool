--- a/src/components/ContactForm.tsx
+++ b/src/components/ContactForm.tsx
@@ -225,7 +225,7 @@
   // Initialize autocomplete web component
   useEffect(() => {
     const initAutocomplete = async () => {
-      if (autocompleteElRef.current) {
+      if (autocompleteElRef.current && typeof google !== 'undefined') {
         try {
           // @ts-expect-error - Google Maps web component
           const { PlaceAutocompleteElement } = await google.maps.importLibrary("places");
@@ -247,19 +247,24 @@
           });
           
           // Also listen for input changes to capture manual typing
-          autocompleteElRef.current.addEventListener('input', (event: Event) => {
-            const target = event.target as HTMLInputElement;
-            const address = target.value || '';
+          const inputHandler = (event: Event) => {
+            const element = autocompleteElRef.current;
+            const address = element?.value || '';
             setFormData(prev => ({ ...prev, preferredShippingAddress: address }));
-          });
+          };
+          autocompleteElRef.current.addEventListener('input', inputHandler);
           
           // Listen for blur event to ensure final value is captured
-          autocompleteElRef.current.addEventListener('blur', (event: Event) => {
-            const target = event.target as HTMLInputElement;
-            const address = target.value || '';
+          const blurHandler = (event: Event) => {
+            const element = autocompleteElRef.current;
+            const address = element?.value || '';
             setFormData(prev => ({ ...prev, preferredShippingAddress: address }));
-          });
+          };
+          autocompleteElRef.current.addEventListener('blur', blurHandler);
+          
+          // Apply black text color to shadow DOM
+          const style = document.createElement('style');
+          style.textContent = 'input { color: #000000 !important; }';
+          autocompleteElRef.current.shadowRoot?.appendChild(style);
         } catch (error) {
           console.error('Error initializing Google Places Autocomplete:', error);
         }
@@ -278,7 +283,11 @@
   const handleSaveShippingAddress = () => {
     // Capture the current value from the autocomplete element
     if (autocompleteElRef.current && autocompleteElRef.current.value) {
-      setFormData(prev => ({ ...prev, preferredShippingAddress: autocompleteElRef.current!.value }));
+      const address = autocompleteElRef.current.value;
+      setFormData(prev => ({ 
+        ...prev, 
+        preferredShippingAddress: address 
+      }));
     }
     setAddressSaved(true);
     setTimeout(() => setAddressSaved(false), 2000);
